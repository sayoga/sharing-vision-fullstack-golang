<!DOCTYPE html>
<html>
    <head>
        <title>JSON Payload</title>
        <script src="static/jquery-1.12.0.min.js"></script>
        <script>
            $(function () {
                // javascript code here
            });
        </script>
    </head>
    <body>
        <p class="message"></p>
        <form id="user-form" method="post" action="/save">
            <!-- html code here -->
            <table noborder>
                <tr>
                    <td><label>Title :</label></td>
                    <td>
                        <input required type="text" name="title" placeholder="Type title here" />
                    </td>
                </tr>
                <tr>
                    <td><label>Content :</label></td>
                    <td>                        
                        <textarea id="content" name="content" rows="4" placeholder="Set content" cols="50">
                         </textarea>
                    </td>
                </tr>                
                <tr>
                    <td><label>Category :</label></td>
                    <td>
                        <input required type="text" name="category" placeholder="Type category here" />
                    </td>
                </tr>
                <tr>
                    <td><label>Status :</label></td>
                    <td>
                        <select name="status" required style="width: 100%;">
                            <option value="">Select one</option>
                            <option value="publish">Publish</option>
                            <option value="draft">Draft</option>
                            <option value="thrash">Thrash</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: right;">
                        <button type="submit">Save</button>
                    </td>
                </tr>
            </table>
        </form>
    </body>
    
    <script>
        $("#user-form").on("submit", function (e) {
            e.preventDefault();

            var $self = $(this);
            var payload = JSON.stringify({
                title: $('[name="title"]').val(),
                content: $('[name="content"]').val(),
                category: $('[name="category"]').val(),
                status: $('[name="status"]').val()
            });

            save($self.attr("method"),$self.attr("action"),payload);
            // $.ajax({
            //     url: $self.attr("action"),
            //     type: $self.attr("method"),
            //     data: payload,
            //     contentType: 'application/json',
            // }).then(function (res) {
            //     $(".message").text(res);
            // }).catch(function (a) {
            //     alert("ERROR: " + a.responseText);
            // });

            
        });

        function save(type0,url0,data0){
            $.ajax({
                type: type0,
                url: url0,
                data: data0,
                contentType: 'application/json',
                success: function (response) {
                    console.log(response);
                    $(".message").text('UPDATE : '+response);
                }
            });
        } 
    </script>
</html>